<!-- inspired by https://discourse.gohugo.io/t/adding-a-photoswipe-gallery-as-a-shortcode-using-page-resources/10672 -->
{{ $centered := cond (eq (.Get "centered") "") "" "centered" }}
{{ $fullWidth := cond (eq (.Get "fullWidth") "") "" "fullWidth" }}
{{ $resizeSize := .Get "resizeSize" | string | default "320" }}
{{ $shouldMakeSquare := .Get "shouldMakeSquare" | string | default "false" }}
{{ $resizeOneDimensionInput := cond (eq (.Get "resizeHeight") "") (printf "%sx" $resizeSize) (printf "x%s" $resizeSize) }}
<div class="galleryContainer {{ $centered }} {{ $fullWidth }}">
    {{ with .Get "title" }}
    <h4>{{ . }}</h4>
    {{ end }}
    <div class="gallery" itemscope itemtype="http://schema.org/ImageGallery">
        {{- range (.Page.Resources.Match (printf "%s*" (.Get "folder"))) }}
            {{ $thumbnail := cond ( eq $shouldMakeSquare "true") (.Fill (printf "%sx%s" $resizeSize $resizeSize)) (.Resize $resizeOneDimensionInput) }}
            <figure itemscope itemtype="http://schema.org/ImageObject" class="image gallery-item">
            <a href="{{ .Permalink }}" itemprop="contentUrl" data-size="{{ .Width }}x{{ .Height }}" >
                <img src="{{ $thumbnail.Permalink }}" itemprop="thumbnail" alt="galleryImage" class="galleryImage" />
            </a>
            <figcaption itemprop="caption description">
                <span itemprop="copyrightHolder"></span>
            </figcaption>
            </figure> 
        {{ end }}
    </div>
    {{ with .Get "caption" }}
    <div class="galleryCaption">{{ . | markdownify }}</div>
    {{ end }}
</div>
